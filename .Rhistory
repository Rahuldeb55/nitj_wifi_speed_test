scatter_d_vs_loss <- ggplot(wifi_data_clean, aes(x = `pk_loss(%)`, y = `d_speed(mbps)`)) +
geom_point(alpha = 0.6, color = "orange") +
labs(
title = "Download Speed vs. Packet Loss",
x = "Packet Loss (%)",
y = "Download Speed (mbps)"
)
print(scatter_d_vs_loss)
ggsave("plot_6_scatter_d_vs_loss.png", scatter_d_vs_loss, width = 8, height = 5)
print("--- Analysis Complete ---")
print("Graphs have been saved to your working directory.")
print("Files created: plot_1_histogram.png, plot_2_box_location.png, plot_3_bar_location.png, plot_4_line_hour.png, plot_5_scatter_d_vs_u.png, plot_6_scatter_d_vs_loss.png")
# ---
# Title: NITJ WiFi Speed Analysis
# Author: [Your Name]
# Date: 2025-11-10
# Description: This R script loads, cleans, and analyzes the NITJ WiFi speed
#              dataset to identify patterns and generate visualizations.
#              (Version 3: Robust outlier filtering)
# ---
# 1. SETUP
# ---
# Install packages if you don't have them (run this line once)
# install.packages(c("tidyverse", "lubridate"))
# Load libraries
library(tidyverse)
library(lubridate)
# Set a theme for all plots
theme_set(theme_minimal())
# 2. LOAD AND CLEAN DATA
# ---
# Load the dataset
# Assuming the CSV file is in the same working directory
file_path <- "NITJ_WiFi_Speed.csv"
wifi_data <- read_csv(file_path)
# Print the first few rows to inspect
print(head(wifi_data))
# Clean the data
wifi_data_clean <- wifi_data %>%
mutate(
# Remove the extra quotes from spot_location
spot_location = gsub('"', '', spot_location, fixed = TRUE),
# Combine date and time into a single datetime object
# mdy_hm stands for Month-Day-Year Hour:Minute
datetime = mdy_hm(paste(date, time)),
# Extract the hour of the day
hour_of_day = hour(datetime)
) %>%
# Remove the old date and time columns
select(-date, -time) %>%
# ---
# ROBUST CLEANING & CONVERSION
# This section now removes commas (e.g., "100,000") *before*
# converting to a number.
# ---
mutate(
`d_speed(mbps)` = as.numeric(gsub(",", "", `d_speed(mbps)`)),
`u_speed(mbps)` = as.numeric(gsub(",", "", `u_speed(mbps)`)),
`pk_loss(%)` = as.numeric(gsub(",", "", `pk_loss(%)`))
) %>%
# ---
# ROBUST FILTERING
# This filter now runs *after* the robust numeric conversion.
# It removes impossible speeds (e.g., 100000)
# ---
filter(
`d_speed(mbps)` < 1000,
`u_speed(mbps)` < 1000
) %>%
# Finally, remove any rows where conversion might have failed
drop_na()
# View the structure of the cleaned data
print(str(wifi_data_clean))
print(paste("Total records after cleaning:", nrow(wifi_data_clean)))
# 3. EXPLORATORY DATA ANALYSIS (EDA)
# ---
# Get overall summary statistics
# *** CHECK THIS OUTPUT ***
# The "Max." value for d_speed and u_speed should be low (e.g., < 50)
print("Overall Summary Statistics (Post-Cleaning):")
print(summary(wifi_data_clean[, c("d_speed(mbps)", "u_speed(mbps)", "pk_loss(%)")]))
# ---
# Plot 1: Distribution of Download Speeds
# ---
hist_d_speed <- ggplot(wifi_data_clean, aes(x = `d_speed(mbps)`)) +
geom_histogram(binwidth = 2, fill = "dodgerblue", color = "black") +
labs(
title = "Distribution of WiFi Download Speeds",
x = "Download Speed (mbps)",
y = "Frequency"
)
print(hist_d_speed)
ggsave("plot_1_histogram.png", hist_d_speed, width = 8, height = 5)
# ---
# Plot 2: Download Speed by Location (Boxplot)
# ---
# coord_flip() is used to make location labels readable
box_d_speed_location <- ggplot(wifi_data_clean, aes(x = spot_location, y = `d_speed(mbps)`)) +
geom_boxplot(fill = "dodgerblue") +
coord_flip() +
labs(
title = "Download Speed by Location",
x = "Location",
y = "Download Speed (mbps)"
)
print(box_d_speed_location)
ggsave("plot_2_box_location.png", box_d_speed_location, width = 8, height = 5)
# ---
# Plot 3: Average Download Speed by Location (Bar Chart)
# ---
avg_speed_location <- wifi_data_clean %>%
group_by(spot_location) %>%
summarise(
avg_d_speed = mean(`d_speed(mbps)`)
)
bar_avg_speed <- ggplot(avg_speed_location, aes(x = reorder(spot_location, avg_d_speed), y = avg_d_speed)) +
geom_bar(stat = "identity", fill = "darkgreen") +
coord_flip() +
labs(
title = "Average Download Speed by Location",
x = "Location",
y = "Average Download Speed (mbps)"
)
print(bar_avg_speed)
ggsave("plot_3_bar_location.png", bar_avg_speed, width = 8, height = 5)
# ---
# Plot 4: Average Download Speed by Hour of Day
# ---
avg_speed_hour <- wifi_data_clean %>%
group_by(hour_of_day) %>%
summarise(
avg_d_speed = mean(`d_speed(mbps)`)
)
line_speed_hour <- ggplot(avg_speed_hour, aes(x = hour_of_day, y = avg_d_speed)) +
geom_line(color = "red", size = 1) +
geom_point(color = "red") +
scale_x_continuous(breaks = seq(0, 23)) + # Show all hours
labs(
title = "Average Download Speed by Hour of Day",
x = "Hour of Day (0-23)",
y = "Average Download Speed (mbps)"
)
print(line_speed_hour)
ggsave("plot_4_line_hour.png", line_speed_hour, width = 8, height = 5)
# ---
# Plot 5: Scatter Plot - Download vs. Upload Speed
# ---
scatter_d_vs_u <- ggplot(wifi_data_clean, aes(x = `d_speed(mbps)`, y = `u_speed(mbps)`)) +
geom_point(alpha = 0.6, color = "purple") +
geom_smooth(method = "lm", color = "black") + # Add a linear regression line
labs(
title = "Download Speed vs. Upload Speed",
x = "Download Speed (mbps)",
y = "Upload Speed (mbps)"
)
print(scatter_d_vs_u)
ggsave("plot_5_scatter_d_vs_u.png", scatter_d_vs_u, width = 8, height = 5)
# ---
# Plot 6: Scatter Plot - Download Speed vs. Packet Loss
# ---
scatter_d_vs_loss <- ggplot(wifi_data_clean, aes(x = `pk_loss(%)`, y = `d_speed(mbps)`)) +
geom_point(alpha = 0.6, color = "orange") +
labs(
title = "Download Speed vs. Packet Loss",
x = "Packet Loss (%)",
y = "Download Speed (mbps)"
)
print(scatter_d_vs_loss)
ggsave("plot_6_scatter_d_vs_loss.png", scatter_d_vs_loss, width = 8, height = 5)
print("--- Analysis Complete ---")
print("Graphs have been saved to your working directory.")
print("Files created: plot_1_histogram.png, plot_2_box_location.png, plot_3_bar_location.png, plot_4_line_hour.png, plot_5_scatter_d_vs_u.png, plot_6_scatter_d_vs_loss.png")
# ---
# Title: NITJ WiFi Speed Analysis
# Author: [Your Name]
# Date: 2025-11-10
# Description: This R script loads, cleans, and analyzes the NITJ WiFi speed
#              dataset to identify patterns and generate visualizations.
#              (Version 3: Robust outlier filtering)
# ---
# 1. SETUP
# ---
# Install packages if you don't have them (run this line once)
# install.packages(c("tidyverse", "lubridate"))
# Load libraries
library(tidyverse)
library(lubridate)
# Set a theme for all plots
theme_set(theme_minimal())
# 2. LOAD AND CLEAN DATA
# ---
# Load the dataset
# Assuming the CSV file is in the same working directory
file_path <- "D:/nitj wifi speed/NITJ_WiFi_Speed.csv"
wifi_data <- read_csv(file_path)
# Print the first few rows to inspect
print(head(wifi_data))
# Clean the data
wifi_data_clean <- wifi_data %>%
mutate(
# Remove the extra quotes from spot_location
spot_location = gsub('"', '', spot_location, fixed = TRUE),
# Combine date and time into a single datetime object
# mdy_hm stands for Month-Day-Year Hour:Minute
datetime = mdy_hm(paste(date, time)),
# Extract the hour of the day
hour_of_day = hour(datetime)
) %>%
# Remove the old date and time columns
select(-date, -time) %>%
# ---
# ROBUST CLEANING & CONVERSION
# This section now removes commas (e.g., "100,000") *before*
# converting to a number.
# ---
mutate(
`d_speed(mbps)` = as.numeric(gsub(",", "", `d_speed(mbps)`)),
`u_speed(mbps)` = as.numeric(gsub(",", "", `u_speed(mbps)`)),
`pk_loss(%)` = as.numeric(gsub(",", "", `pk_loss(%)`))
) %>%
# ---
# ROBUST FILTERING
# This filter now runs *after* the robust numeric conversion.
# It removes impossible speeds (e.g., 100000)
# ---
filter(
`d_speed(mbps)` < 1000,
`u_speed(mbps)` < 1000
) %>%
# Finally, remove any rows where conversion might have failed
drop_na()
# View the structure of the cleaned data
print(str(wifi_data_clean))
print(paste("Total records after cleaning:", nrow(wifi_data_clean)))
# 3. EXPLORATORY DATA ANALYSIS (EDA)
# ---
# Get overall summary statistics
# *** CHECK THIS OUTPUT ***
# The "Max." value for d_speed and u_speed should be low (e.g., < 50)
print("Overall Summary Statistics (Post-Cleaning):")
print(summary(wifi_data_clean[, c("d_speed(mbps)", "u_speed(mbps)", "pk_loss(%)")]))
# ---
# Plot 1: Distribution of Download Speeds
# ---
hist_d_speed <- ggplot(wifi_data_clean, aes(x = `d_speed(mbps)`)) +
geom_histogram(binwidth = 2, fill = "dodgerblue", color = "black") +
labs(
title = "Distribution of WiFi Download Speeds",
x = "Download Speed (mbps)",
y = "Frequency"
)
print(hist_d_speed)
ggsave("plot_1_histogram.png", hist_d_speed, width = 8, height = 5)
# ---
# Plot 2: Download Speed by Location (Boxplot)
# ---
# coord_flip() is used to make location labels readable
box_d_speed_location <- ggplot(wifi_data_clean, aes(x = spot_location, y = `d_speed(mbps)`)) +
geom_boxplot(fill = "dodgerblue") +
coord_flip() +
labs(
title = "Download Speed by Location",
x = "Location",
y = "Download Speed (mbps)"
)
print(box_d_speed_location)
ggsave("plot_2_box_location.png", box_d_speed_location, width = 8, height = 5)
# ---
# Plot 3: Average Download Speed by Location (Bar Chart)
# ---
avg_speed_location <- wifi_data_clean %>%
group_by(spot_location) %>%
summarise(
avg_d_speed = mean(`d_speed(mbps)`)
)
bar_avg_speed <- ggplot(avg_speed_location, aes(x = reorder(spot_location, avg_d_speed), y = avg_d_speed)) +
geom_bar(stat = "identity", fill = "darkgreen") +
coord_flip() +
labs(
title = "Average Download Speed by Location",
x = "Location",
y = "Average Download Speed (mbps)"
)
print(bar_avg_speed)
ggsave("plot_3_bar_location.png", bar_avg_speed, width = 8, height = 5)
# ---
# Plot 4: Average Download Speed by Hour of Day
# ---
avg_speed_hour <- wifi_data_clean %>%
group_by(hour_of_day) %>%
summarise(
avg_d_speed = mean(`d_speed(mbps)`)
)
line_speed_hour <- ggplot(avg_speed_hour, aes(x = hour_of_day, y = avg_d_speed)) +
geom_line(color = "red", size = 1) +
geom_point(color = "red") +
scale_x_continuous(breaks = seq(0, 23)) + # Show all hours
labs(
title = "Average Download Speed by Hour of Day",
x = "Hour of Day (0-23)",
y = "Average Download Speed (mbps)"
)
print(line_speed_hour)
ggsave("plot_4_line_hour.png", line_speed_hour, width = 8, height = 5)
# ---
# Plot 5: Scatter Plot - Download vs. Upload Speed
# ---
scatter_d_vs_u <- ggplot(wifi_data_clean, aes(x = `d_speed(mbps)`, y = `u_speed(mbps)`)) +
geom_point(alpha = 0.6, color = "purple") +
geom_smooth(method = "lm", color = "black") + # Add a linear regression line
labs(
title = "Download Speed vs. Upload Speed",
x = "Download Speed (mbps)",
y = "Upload Speed (mbps)"
)
print(scatter_d_vs_u)
ggsave("plot_5_scatter_d_vs_u.png", scatter_d_vs_u, width = 8, height = 5)
# ---
# Plot 6: Scatter Plot - Download Speed vs. Packet Loss
# ---
scatter_d_vs_loss <- ggplot(wifi_data_clean, aes(x = `pk_loss(%)`, y = `d_speed(mbps)`)) +
geom_point(alpha = 0.6, color = "orange") +
labs(
title = "Download Speed vs. Packet Loss",
x = "Packet Loss (%)",
y = "Download Speed (mbps)"
)
print(scatter_d_vs_loss)
ggsave("plot_6_scatter_d_vs_loss.png", scatter_d_vs_loss, width = 8, height = 5)
print("--- Analysis Complete ---")
print("Graphs have been saved to your working directory.")
print("Files created: plot_1_histogram.png, plot_2_box_location.png, plot_3_bar_location.png, plot_4_line_hour.png, plot_5_scatter_d_vs_u.png, plot_6_scatter_d_vs_loss.png")
# ---
# Title: NITJ WiFi Speed Analysis
# Author: [Your Name]
# Date: 2025-11-10
# Description: This R script loads, cleans, and analyzes the NITJ WiFi speed
#              dataset to identify patterns and generate visualizations.
#              (Version 4: Added janitor for robust name cleaning)
# ---
# 1. SETUP
# ---
# Install packages if you don't have them (run this line once)
# install.packages(c("tidyverse", "lubridate", "janitor"))
# Load libraries
library(tidyverse)
library(lubridate)
library(janitor) # For the clean_names() function
install.packages(c("tidyverse", "lubridate", "janitor"))
# ---
# Title: NITJ WiFi Speed Analysis
# Author: [Your Name]
# Date: 2025-11-10
# Description: This R script loads, cleans, and analyzes the NITJ WiFi speed
#              dataset to identify patterns and generate visualizations.
#              (Version 4: Added janitor for robust name cleaning)
# ---
# 1. SETUP
# ---
# Install packages if you don't have them (run this line once)
# install.packages(c("tidyverse", "lubridate", "janitor"))
# Load libraries
library(tidyverse)
library(lubridate)
library(janitor) # For the clean_names() function
# Set a theme for all plots
theme_set(theme_minimal())
# 2. LOAD AND CLEAN DATA
# ---
# Load the dataset
# Assuming the CSV file is in the same working directory
file_path <- "D:/nitj wifi speed/NITJ_WiFi_Speed.csv"
wifi_data <- read_csv(file_path)
# Print the first few rows to inspect
print(head(wifi_data))
# Clean the data
wifi_data_clean <- wifi_data %>%
# ---
# NEW STEP: Clean column names
# This converts "d_speed(mbps)" to "d_speed_mbps"
# This is much more robust.
clean_names() %>%
# ---
mutate(
# Remove the extra quotes from spot_location
spot_location = gsub('"', '', spot_location, fixed = TRUE),
# Combine date and time into a single datetime object
datetime = mdy_hm(paste(date, time)),
# Extract the hour of the day
hour_of_day = hour(datetime)
) %>%
# Remove the old date and time columns
select(-date, -time) %>%
# ---
# ROBUST CLEANING & CONVERSION
# We now use the clean names (e.g., d_speed_mbps)
# ---
mutate(
d_speed_mbps = as.numeric(gsub(",", "", d_speed_mbps)),
u_speed_mbps = as.numeric(gsub(",", "", u_speed_mbps)),
pk_loss_percent = as.numeric(gsub(",", "", pk_loss_percent))
) %>%
# ---
# RE-ORDERED CLEANING
# 1. Drop rows that failed to convert (became NA)
# 2. Filter numeric outliers that *did* convert
# ---
drop_na(d_speed_mbps, u_speed_mbps) %>%
filter(
d_speed_mbps < 1000,
u_speed_mbps < 1000
)
# View the structure of the cleaned data
print(str(wifi_data_clean))
print(paste("Total records after cleaning:", nrow(wifi_data_clean)))
# 3. EXPLORATORY DATA ANALYSIS (EDA)
# ---
# Get overall summary statistics
# *** CHECK THIS OUTPUT ***
# The "Max." value for d_speed and u_speed should be low (e.g., < 50)
print("Overall Summary Statistics (Post-Cleaning):")
print(summary(wifi_data_clean[, c("d_speed_mbps", "u_speed_mbps", "pk_loss_percent")]))
# ---
# Plot 1: Distribution of Download Speeds
# ---
hist_d_speed <- ggplot(wifi_data_clean, aes(x = d_speed_mbps)) +
geom_histogram(binwidth = 2, fill = "dodgerblue", color = "black") +
labs(
title = "Distribution of WiFi Download Speeds",
x = "Download Speed (mbps)",
y = "Frequency"
)
print(hist_d_speed)
ggsave("plot_1_histogram.png", hist_d_speed, width = 8, height = 5)
# ---
# Plot 2: Download Speed by Location (Boxplot)
# ---
box_d_speed_location <- ggplot(wifi_data_clean, aes(x = spot_location, y = d_speed_mbps)) +
geom_boxplot(fill = "dodgerblue") +
coord_flip() +
labs(
title = "Download Speed by Location",
x = "Location",
y = "Download Speed (mbps)"
)
print(box_d_speed_location)
ggsave("plot_2_box_location.png", box_d_speed_location, width = 8, height = 5)
# ---
# Plot 3: Average Download Speed by Location (Bar Chart)
# ---
avg_speed_location <- wifi_data_clean %>%
group_by(spot_location) %>%
summarise(
avg_d_speed = mean(d_speed_mbps)
)
bar_avg_speed <- ggplot(avg_speed_location, aes(x = reorder(spot_location, avg_d_speed), y = avg_d_speed)) +
geom_bar(stat = "identity", fill = "darkgreen") +
coord_flip() +
labs(
title = "Average Download Speed by Location",
x = "Location",
y = "Average Download Speed (mbps)"
)
print(bar_avg_speed)
ggsave("plot_3_bar_location.png", bar_avg_speed, width = 8, height = 5)
# ---
# Plot 4: Average Download Speed by Hour of Day
# ---
avg_speed_hour <- wifi_data_clean %>%
group_by(hour_of_day) %>%
summarise(
avg_d_speed = mean(d_speed_mbps)
)
line_speed_hour <- ggplot(avg_speed_hour, aes(x = hour_of_day, y = avg_d_speed)) +
geom_line(color = "red", size = 1) +
geom_point(color = "red") +
scale_x_continuous(breaks = seq(0, 23)) + # Show all hours
labs(
title = "Average Download Speed by Hour of Day",
x = "Hour of Day (0-23)",
y = "Average Download Speed (mbps)"
)
print(line_speed_hour)
ggsave("plot_4_line_hour.png", line_speed_hour, width = 8, height = 5)
# ---
# Plot 5: Scatter Plot - Download vs. Upload Speed
# ---
scatter_d_vs_u <- ggplot(wifi_data_clean, aes(x = d_speed_mbps, y = u_speed_mbps)) +
geom_point(alpha = 0.6, color = "purple") +
geom_smooth(method = "lm", color = "black") + # Add a linear regression line
labs(
title = "Download Speed vs. Upload Speed",
x = "Download Speed (mbps)",
y = "Upload Speed (mbps)"
)
print(scatter_d_vs_u)
ggsave("plot_5_scatter_d_vs_u.png", scatter_d_vs_u, width = 8, height = 5)
# ---
# Plot 6: Scatter Plot - Download Speed vs. Packet Loss
# ---
scatter_d_vs_loss <- ggplot(wifi_data_clean, aes(x = pk_loss_percent, y = d_speed_mbps)) +
geom_point(alpha = 0.6, color = "orange") +
labs(
title = "Download Speed vs. Packet Loss",
x = "Packet Loss (%)",
y = "Download Speed (mbps)"
)
print(scatter_d_vs_loss)
ggsave("plot_6_scatter_d_vs_loss.png", scatter_d_vs_loss, width = 8, height = 5)
print("--- Analysis Complete ---")
print("Graphs have been saved to your working directory.")
print("Files created: plot_1_histogram.png, plot_2_box_location.png, plot_3_bar_location.png, plot_4_line_hour.png, plot_5_scatter_d_vs_u.png, plot_6_scatter_d_vs_loss.png")
